# **create_settings_page.md**

**Task ID:** `T_CREATE_SETTINGS_PAGE`
**Goal:** Add a Settings Page accessible from the left sidebar, implement Light/Dark Mode using persisted preferences, and include several other configurable settings related to existing functionality.

---

# ğŸ“ **Task Summary**

Add a **Settings button** in the left sidebar (directly below â€œStatsâ€) that navigates to a new **Settings Page** at route:

```
/settings
```

Settings must be **per device** (stored in localStorage) and **not tied to individual student profiles** unless explicitly noted.

---

# ğŸ¯ **REQUIRED SETTINGS**

At minimum, the Settings Page must include:

---

## 1. **Light / Dark Mode**

A toggle:

```
[ Light ]   [ Dark ]   [ System ]
```

Implementation details:

* Use CSS variables or Tailwind dark mode (`class="dark"`).
* Store user choice in `localStorage.settings.theme`.
* Apply theme immediately without reloading.
* On startup, read from localStorage and apply.

---

# ğŸŸ¦ **ADDITIONAL SETTINGS (based on existing features)**

These settings make sense given what your app already does and will not require backend.

The agent should add controls for:

---

## 2. **Keyboard Settings**

```
âœ“ Show key highlights (on/off)
âœ“ Animate wrong keys (shake) (on/off)
âœ“ Simplified keyboard (letters only) / QWERTY
```

---

## 3. **Variant Display Settings**

(affects WordStrip component)

```
âœ“ Show font variants (on/off)
âœ“ Show syllables (on/off)
âœ“ Show segments (on/off)
âœ“ Show uppercase/lowercase alternation (on/off)
```

These should override Level defaults *only if explicitly changed.*

---

## 4. **Animation Settings**

```
âœ“ Enable confetti on success (on/off)
âœ“ Enable tile animations (on/off)
âœ“ Enable â€œTry againâ€ soft vibration animation (on/off)
```

---

## 5. **Sound Settings**

(No audio in loops, but UI could have optional soft click sounds)

```
âœ“ Keyboard click sounds (on/off)
âœ“ Success sound (on/off)
âœ“ Error sound (on/off)
```

(All default OFF)

---

## 6. **Gameplay Difficulty Settings**

Allow parent to fine-tune behavior:

```
âœ“ Auto-advance after word success (on/off)
âœ“ Require Enter key to advance (on/off)
âœ“ Show next letter hint (on/off)
âœ“ Speed challenge mode (on/off)
```

---

## 7. **Profile-Specific Overrides** (optional)

Switch for:

```
[ ] Allow profile-specific settings
```

If enabled, store settings inside each profile object:

```
profiles[profileId].settings
```

If disabled, use global settings.

---

# ğŸ¨ **UI Requirements**

### A. Settings Button

Place in left sidebar:

```
[ Stats ] [ Settings ]
```

Button style should match Stats.

---

### B. Settings Page Layout

Sectioned view:

```
Settings
---------
Theme
Keyboard
Word Display
Animations
Sounds
Gameplay
Advanced
```

Use toggles, dropdowns, and checkboxes.

---

# ğŸ”§ **TECHNICAL REQUIREMENTS**

## A. New Settings Store

Create:

```
src/engine/SettingsManager.ts
```

Must support:

```ts
getSettings()
updateSettings(partial)
subscribe(listener)
resetSettings()
```

Data stored in:

```
localStorage.settings
```

Initial settings must fall back to defaults when missing.

---

## B. Routing

Add a route for:

```
/settings
```

Must NOT refresh the page (use SPA navigation).

---

## C. Page Component

Create file:

```
src/pages/SettingsPage.tsx
```

Reads and writes from SettingsManager.

---

## D. Theme Application

Update root HTML or App component:

* Apply `class="dark"` for dark mode.
* Apply `class=""` for light mode.
* If â€œsystemâ€, use:

```ts
window.matchMedia("(prefers-color-scheme: dark)")
```

And listen for changes.

---

## E. Integration With GameScreen

Settings must affect:

* Keyboard display
* Animation behaviors
* WordStrip variants
* Sound toggles
* Progression flow
* Theme

GameScreen must read settings via:

```ts
const settings = useSettings();
```

---

# ğŸ§ª **ACCEPTANCE CRITERIA**

* Settings Page accessible from the sidebar
* Light/Dark Mode works immediately and persists
* Settings sync to localStorage
* App loads with chosen theme on refresh
* All toggles affect the game immediately
* Deleting a profile does NOT delete global settings
* Options are grouped and readable

---

# ğŸ“¦ **DELIVERABLES**

* `SettingsManager.ts`
* `SettingsPage.tsx`
* Updated Sidebar (Settings button)
* Theme system implementation
* Hook or context: `useSettings()`
* Updated components reacting to settings
